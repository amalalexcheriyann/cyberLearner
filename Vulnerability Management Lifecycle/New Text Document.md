ðŸ›¡ï¸ Vulnerability Management Lifecycle: End-to-End Hardening Project

ðŸ“‹ Executive Summary

This project demonstrates a complete Vulnerability Management Lifecycle, simulating a real-world engagement to secure a compromised legacy Linux server ("Metasploitable 2").



Moving beyond simple "Capture the Flag" exploitation, the primary objective was to act as a Security Engineer: I identified critical risks, validated them through proof-of-concept exploits, troubleshooting complex service dependencies, and implemented permanent remediation to harden the system against future attacks.



ðŸ› ï¸ Technical Architecture

Target System: Metasploitable 2 (Linux Kernel 2.6.24)



Security Assessment: Tenable Nessus Essentials, Nmap



Exploitation Tools: Metasploit Framework, Netcat (nc), VNCViewer



Remediation Tools: Linux System Administration (sed, xinetd, iptables, netstat)



ðŸ” Phase 1: Discovery (Assessment)

The engagement began with a comprehensive network scan to map the attack surface and identify potential entry points.



Tools Used: Tenable Nessus Essentials \& Nmap



Objective: Filter out "noise" and prioritize Critical (CVSS 10.0) vulnerabilities.



Key Findings:



ðŸš¨ Port 1524 (Ingreslock): A "Bind Shell" backdoor was detected, potentially allowing unauthenticated root access.



ðŸš¨ Port 5900 (VNC): The remote desktop service was flagged for using weak authentication ("password").



ðŸš¨ Port 6667 (UnrealIRCd): The IRC daemon was identified as a compromised version containing a malicious backdoor.



> Figure 1: Nessus Dashboard highlighting critical vulnerabilities.



âš”ï¸ Phase 2: Validation (Exploitation)

To verify the scan results and rule out false positives, I performed manual ethical exploitation of the identified services.



1\. Validating the "Bind Shell" (Port 1524)

The most severe finding was an open port that allegedly provided direct root access. I verified this using Netcat to connect directly to the service.



Command: nc 10.0.2.3 1524



Result: The system immediately returned a root shell without prompting for credentials, confirming the critical risk level.



> Figure 2: Instant root access obtained via Netcat.



2\. Validating Weak VNC Credentials (Port 5900)

I tested the scanner's finding by attempting to log in with the flagged password.



Tool: vncviewer



Credential: password



Result: Successful authentication yielded full graphical control of the server.



> Figure 3: Full remote desktop access achieved.



ðŸ›¡ï¸ Phase 3: Remediation (System Hardening)

This phase constituted the core technical challenge of the project. Simply identifying the bugs was insufficient; the goal was to patch the root causes permanently.



Challenge: The "Zombie" Process on Port 1524

Initial attempts to close the Bind Shell by restarting the standard inetd service failed. The port remained open despite configuration changes.



Troubleshooting Process:



Service Enumeration: I used netstat with the -antp flags to identify the specific Process ID (PID) holding the port open.



Bash

sudo netstat -antp | grep 1524

Root Cause Analysis: The output revealed that the service was not managed by inetd as expected, but by xinetd (Extended Internet Services Daemon), with a listener at PID 4520. Additionally, several "zombie" bash sessions (PIDs 11406, 11382) were keeping connections alive.



Manual Termination: I executed a targeted kill command to terminate the listener and the zombie sessions.



Bash

sudo kill -9 4520 11406 11382

Configuration Patching: I used the stream editor sed to programmatically comment out the malicious configuration line in /etc/inetd.conf to prevent the service from restarting on reboot.



Bash

sudo sed -i 's/^1524/#1524/' /etc/inetd.conf

> Figure 4: Manual process termination and configuration patching.



Securing Remote Access (VNC)

Terminated the insecure VNC process running with root privileges.



Deployed a new VNC instance under a non-privileged user account.



Enforced a strong password policy using vncpasswd.



âœ… Phase 4: Verification (Audit)

To ensure the effectiveness of the remediation measures, I conducted a final audit of the target system.



Results:



Port 1524: Connection attempts via Netcat now return "Connection Refused", confirming the backdoor is closed.



Port 5900: The insecure VNC service is no longer accessible.



Port 6667: Traffic to the IRC port is now blocked via firewall rules.



> Figure 5: Final validation showing the attack vectors have been neutralized.



ðŸ’¡ Project Retrospective

This project highlighted the distinction between identifying a vulnerability and fixing it. While automated scanners like Nessus are invaluable for discovery, effective remediation requires a deep understanding of Linux system internalsâ€”specifically process management, service daemons (inetd vs xinetd), and network configuration.



By manually troubleshooting the persistent listener on Port 1524, I gained significant insight into how legacy services manage connections and how to effectively harden a system against persistence mechanisms.

